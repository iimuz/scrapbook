<!doctype html><html lang=en><head><title>Unityと blenderハンズオンの第3章を進めてみる | しさく</title><meta charset=utf-8><meta name=generator content="Hugo 0.60.1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=x-ua-compatible content="IE=edge"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="UnityとBlenderハンズオンの第3章を進めてみる"><meta name=description content="静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開
に沿って進めてみる。"><meta property="og:description" content="静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開
に沿って進めてみる。"><meta property="og:url" content="https://iimuz.github.io/scrapbook/software/shizuokadevunityandblender03/"><meta property="og:image" content="images/%!s()"><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content><meta name=twitter:title content="UnityとBlenderハンズオンの第3章を進めてみる"><meta property="twitter:description" content="静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開
に沿って進めてみる。"><meta name=twitter:image content="images/%!s()"><link rel=apple-touch-icon sizes=180x180 href=https://iimuz.github.io/scrapbook/images/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://iimuz.github.io/scrapbook/images/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://iimuz.github.io/scrapbook/images/icons/favicon-16x16.png><link rel=manifest href=https://iimuz.github.io/scrapbook/images/icons/site.webmanifest><link rel=canonical href=https://iimuz.github.io/scrapbook/software/shizuokadevunityandblender03/><link rel=stylesheet href=https://iimuz.github.io/scrapbook/css/styles.a1e1a9f0e58a84cfca79c98c11b9e900971b61f840c5fbe7f3ddad8ebcd9798517a0ea30089562091e9105239ce941ccc4953d8c3a0c08a2f5082ace791f0186.css integrity="sha512-oeGp8OWKhM/KecmMEbnpAJcbYfhAxfvn892tjrzZeYUXoOowCJViCR6RBSOc6UHMxJU9jDoMCKL1CCrOeR8Bhg=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css></head><body><div class=nav-drop><div class=nav-body><a href=https://iimuz.github.io/scrapbook/search/ class=nav_item>search</a>
<a href=https://iimuz.github.io/scrapbook/tags/ class=nav_item>tags</a>
<a href=https://iimuz.github.io/scrapbook/categories/ class=nav_item>categories</a>
<a href=https://github.com/iimuz/til/ class=nav_item>til</a><div class=nav-close></div></div></div><header class=nav><nav class=nav-menu><a href=https://iimuz.github.io/scrapbook/ class="nav-brand nav_item">しさく</a><div class=nav_bar-wrap><div class=nav_bar></div></div></nav></header><main><section class=post_header style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)><h1 class=post_title>UnityとBlenderハンズオンの第3章を進めてみる</h1></section><div class=post><article class=post_content><div><i class="far fa-calendar-check"></i>2015-05-05 00:00:00 +0900 +0900
<i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div><p><a href=http://yaju3d.hatenablog.jp/entry/2015/04/07/015641>静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開</a>
に沿って進めてみる。</p><h2 id=heading>パックマンもどきの作成</h2><p><a href=http://noobtuts.com/unity/2d-pacman-game>noobtuts: Unity 2D Pac-Man Tutorial</a>に沿って、パックマンもどきを作成する。</p><p>パックマンもどき: <a href=https://github.com/iimuz/unityTutorials/tree/master/shizuokaDev/pacmanClone>GitHub: pacmanClone</a></p><h3 id=maze-physics>Maze Physics</h3><p>Add ComponentsからPhysics 2DでBox Collider 2Dを追加する。
形状は、Edit Colliderを押して壁に合わせる。</p><p>ここは、かなりめんどくさい…。
より複雑な形状を作ろうとするなら、
ブロック(衝突判定付)のPrefub作って、それを配置したほうが、まだ早そう。
スクリプトで生成する方法もあるだろうけど、
実際に作ること考えたら画面上で動かしたほうが、やり易いだろうし。</p><h2 id=adding-packman>Adding Pack-Man</h2><p>画像をUnity内で分割して利用する場合は、Import設定で、Sprite ModeをMultiplyにする。
それから、Sprite Editorを押すと分割処理ができる。
これを実行すると、Projectの該当画像の下階層に分割した画像が生成される。</p><p>アニメーションは、アニメーションに利用する画像を一括選択し、SceneにD&Dすることで生成される。
そのとき適当にアニメーション名を設定して保存すればよい。</p><p>アニメーションの再生は、無限ループになるらしい。</p><blockquote><p>Note:
Unity will play the right animation over and over again while in right state.
It will use Transitions to know when to switch to another state.
Unity does all of that automatically,
all we have to do is notify it about Pac-Man's movement direction from within a Script later on.</p></blockquote><p>アニメーションのメカニズムについては、
controllerファイル(pacman_0)を開いて、right(既にある)、left、up、downを全てD&Dで放り込む。</p><p>アニメーションタブのParametersで追加(プラスボタン)を選択後、
FloatでDirXとDirYを作成する。これでスクリプトから以下のことができるらしい。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#>GetComponent&lt;Animator&gt;().SetFloat(<span style=color:#e6db74>&#34;DirX&#34;</span>, <span style=color:#ae81ff>0</span>);
GetComponent&lt;Animator&gt;().SetFloat(<span style=color:#e6db74>&#34;DirY&#34;</span>, <span style=color:#ae81ff>0</span>);
</code></pre></div><p>AnyStateから右クリックで遷移線を引いて、&ldquo;Can Transision To Self"のチェックを外す。
これは、毎回毎回繰り返しアニメーションが最初から開始されないようにするためらしい。
Conditionsの大小比較は、GreaterとLesserを選択する。</p><blockquote><p>Note:
this avoids weird situations where an animation would be restarted all the time
while holding down a movement key.</p></blockquote><p>アニメーションの変更はPackmanのFixedUpdate関数のスクリプト部分で、
以下のように記述して値を変更することで実現する。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#>Vector2 dir = dest - (Vector2)transform.position;
GetComponent&lt;Animator&gt;().SetFloat(<span style=color:#e6db74>&#34;DirX&#34;</span>, dir.x);
GetComponent&lt;Animator&gt;().SetFloat(<span style=color:#e6db74>&#34;DirY&#34;</span>, dir.y);
</code></pre></div><p>Pacmanを常に全面に表示するためには、Sprite Renderer -> Order Layerを1にする。
これは、OrderLayerが小さい順にUnityが描画するから。</p><blockquote><p>Note:
Unity draws objects sorted by their order.
It starts with the lowest order and continues with higher orders.
So if Pac-Man has the order 1 then he's always drawn
after the maze and the food and anything else with order 0.
And because he's drawn after everything else, he's automatically in front of everything else.</p></blockquote><p>また、表示順の制御は、2通りあり(Sprite Render's Sorting layer or Order in Layer)、
今回は簡単な後者のOrder in Layerを利用しているが、
複雑な場合はSprite Render's Sorting layerのほうがよいらしい。</p><blockquote><p>There are two ways to do this.
We could either change the Sprite Renderer's Sorting Layer property
or we could change the Order in Layer property.
The Sorting Layer is important for bigger games with far more objects.
For us it's enough to simply change the Order in Layer to 1:</p></blockquote><p>ちなみにSprite Render's Sorting Layerを利用する方は、
第2章のほうで行った<a href=http://noobtuts.com/unity/2d-arkanoid-game>noobtuts: Unity 2D Arkanoid Tutorial</a>の方で行っている。</p><h3 id=the-pacdots>The Pac-Dots</h3><p>Pac-Dotsのように衝突判定がほしいだけの時は、Box Collider 2Dのis TriggerをONにする。
おそらくその名の通りトリガがほしいだけの物体につけるフラグと思われる。</p><blockquote><p>Note:
a Collider with IsTrigger enabled only receives collision information,
it does not physically collide with other things.</p></blockquote><p>Pac-Dotsもかなりの量があって作るのが大変。
今回は、一行分を作って、それをPrefubにして、コピーの繰り返し。
いらない場所を消すことでPrefubではなくなるけど別に問題ないはず。</p><h3 id=the-gosts>The Gosts</h3><p>Waypoint(Empty Object)で作成し、その位置を順に巡回するように設定する。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=color:#66d9ef>void</span> FixedUpdate() {
  <span style=color:#66d9ef>if</span> (transform.position != waypoints[cur].position) {
    <span style=color:#75715e>// Waypoint is not reached yet? then move closer
</span><span style=color:#75715e></span>    Vector2 p = Vector2.MoveTowards(transform.position,
        waypoints[cur].position,
        speed);
    GetComponent&lt;Rigidbody2D&gt;().MovePosition(p);
  } <span style=color:#66d9ef>else</span> {
    <span style=color:#75715e>// Waypoint reached. select next one;
</span><span style=color:#75715e></span>    cur = (cur + <span style=color:#ae81ff>1</span>) % waypoints.Length;
  }
</code></pre></div><p>最後に、Pinky、Inky、Clydeの追加があるが、同じ作業の繰り返しのため省略する。</p><h2 id=blender->Blender: 人のモデルを作る</h2><p><a href=http://yaju3d.hatenablog.jp/entry/2015/04/07/015641>静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開</a>の
p.81からの説明に沿って人のモデルを作成する。</p><p>一通り知っていることだったので、そのまま作って終わり。</p><p>本章までの人モデルの作成データ: <a href=https://github.com/iimuz/blenderTutorials/tree/master/shizuokaDeveloper/chapter03>GitHub: Human</a></p><h2 id=heading1>参考資料</h2><ul><li><a href=http://yaju3d.hatenablog.jp/entry/2015/04/07/015641>静岡Developers勉強会の「UnityとBlenderハンズオン第3章」の資料公開</a></li><li><a href=http://noobtuts.com/unity/2d-pacman-game>noobtuts: Unity 2D Pac-Man Tutorial</a></li><li><a href=http://noobtuts.com/unity/2d-arkanoid-game>noobtuts: Unity 2D Arkanoid Tutorial</a></li></ul><div class=post_extra><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div></article><aside><h3>Referenced from</h3><ul class="posts aside"></ul><h3>UnityとBlenderハンズオンの第1章を進めてみる</h3><ul class="posts aside"><li class=post_item><a class=post_card href=/scrapbook/software/shizuokadevunityandblender01/ title=UnityとBlenderハンズオンの第1章を進めてみる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/shizuokadevunityandblender01/>UnityとBlenderハンズオンの第1章を進めてみる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/blender/ title=Blender style=background-image:url(https://upload.wikimedia.org/wikipedia/commons/3/3c/Logo_Blender.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/blender/>Blender</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/shizuokadevunityandblender02/ title=UnityとBlenderハンズオンの第2章を進めてみる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/shizuokadevunityandblender02/>UnityとBlenderハンズオンの第2章を進めてみる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/unity/ title=Unity style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/unity/>Unity</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/shizuokadevunityandblender02/ title=UnityとBlenderハンズオンの第2章を進めてみる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/shizuokadevunityandblender02/>UnityとBlenderハンズオンの第2章を進めてみる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li></ul><h3>More from しさく</h3><ul class="posts aside"><li class=post_item><a class=post_card href=/scrapbook/software/jekyllsearch/ title=Jekyllでサイト内検索(Googleカスタム検索)を入れる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/jekyllsearch/>Jekyllでサイト内検索(Googleカスタム検索)を入れる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/minecraftinvasionmod/ title=Minecraftで侵略mod style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/minecraftinvasionmod/>Minecraftで侵略mod</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/shizuokadevunityandblender02/ title=UnityとBlenderハンズオンの第2章を進めてみる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/shizuokadevunityandblender02/>UnityとBlenderハンズオンの第2章を進めてみる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/shizuokadevunityandblender01/ title=UnityとBlenderハンズオンの第1章を進めてみる style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/shizuokadevunityandblender01/>UnityとBlenderハンズオンの第1章を進めてみる</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li><li class=post_item><a class=post_card href=/scrapbook/software/unitytutorial/ title=Unity導入 style=background-image:url(https://iimuz.github.io/scrapbook/images/thumbnail.svg)></a><div class=excerpt><div class=excerpt_meta><a href=https://iimuz.github.io/scrapbook/tags/software class=post_tag>software</a><div class=copy data-share="Share Story" data-copied="Link Copied"><svg><use xlink:href="#copy"/></svg></div></div><h3 class=post_link><a href=/scrapbook/software/unitytutorial/>Unity導入</a></h3><div class=post_link><div><i class="far fa-edit"></i>2020-01-30 21:19:21 +0900 +0900</div></div></div></li></ul></aside></div><script src=https://iimuz.github.io/scrapbook/js/autosize.min.js></script><script src=https://iimuz.github.io/scrapbook/js/timeago.js></script></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 699.428 699.428" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M502.714.0H240.428C194.178.0 153 42.425 153 87.429l-25.267.59c-46.228.0-84.019 41.834-84.019 86.838V612c0 45.004 41.179 87.428 87.429 87.428H459c46.249.0 87.428-42.424 87.428-87.428h21.857c46.25.0 87.429-42.424 87.429-87.428v-349.19zM459 655.715H131.143c-22.95.0-43.714-21.441-43.714-43.715V174.857c0-22.272 18.688-42.993 41.638-42.993l23.933-.721v393.429C153 569.576 194.178 612 240.428 612h262.286c0 22.273-20.765 43.715-43.714 43.715zm153-131.143c0 22.271-20.765 43.713-43.715 43.713H240.428c-22.95.0-43.714-21.441-43.714-43.713V87.429c0-22.272 20.764-43.714 43.714-43.714H459c-.351 50.337.0 87.975.0 87.975.0 45.419 40.872 86.882 87.428 86.882H612zm-65.572-349.715c-23.277.0-43.714-42.293-43.714-64.981V44.348L612 174.857zm-43.714 131.537H306c-12.065.0-21.857 9.77-21.857 21.835s9.792 21.835 21.857 21.835h196.714c12.065.0 21.857-9.771 21.857-21.835.0-12.065-9.792-21.835-21.857-21.835zm0 109.176H306c-12.065.0-21.857 9.77-21.857 21.834.0 12.066 9.792 21.836 21.857 21.836h196.714c12.065.0 21.857-9.77 21.857-21.836.0-12.064-9.792-21.834-21.857-21.834z"/></symbol><symbol viewBox="0 0 60.015 60.015" xmlns="http://www.w3.org/2000/svg" id="reply"><path d="M42.007.0h-24c-9.925.0-18 8.075-18 18v14c0 9.59 7.538 17.452 17 17.973v8.344a1.694 1.694.0 001.699 1.698c.44.0.873-.173 1.198-.498l1.876-1.876C26.708 52.713 33.259 50 40.227 50h1.78c9.925.0 18-8.075 18-18V18c0-9.925-8.075-18-18-18zm16 32c0 8.822-7.178 16-16 16h-1.78c-7.502.0-14.556 2.921-19.86 8.226l-1.359 1.359V44a1 1 0 10-2 0v3.949c-8.356-.52-15-7.465-15-15.949V18c0-8.822 7.178-16 16-16h24c8.822.0 16 7.178 16 16v14z"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><p>&copy; <span class=year></span>しさく</p><p>Designed by <a href="<no value>" title="Linkedin Profile"><no value></a></p></div></footer><script src=https://iimuz.github.io/scrapbook/js/index.js></script></body></html>